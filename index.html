<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>EcoFinance - Sistema Financeiro</title>
<link rel="stylesheet" href="css/style.css">
</head>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
  import { 
    getAuth, 
    createUserWithEmailAndPassword, 
    signInWithEmailAndPassword,
    onAuthStateChanged,
    signOut
  } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

  const firebaseConfig = {
  apiKey: "AIzaSyAPEv9rP_Ek60NrGfMJnEO3dPzFM4j36cI",
  authDomain: "master-finance-bce36.firebaseapp.com",
  projectId: "master-finance-bce36",
  storageBucket: "master-finance-bce36.firebasestorage.app",
  messagingSenderId: "241893077182",
  appId: "1:241893077182:web:b8100d0ca968ba90a42eef"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);

  // CADASTRO
  window.cadastrar = (email, senha) => {
    createUserWithEmailAndPassword(auth, email, senha)
      .then(() => alert("Usuário criado!"))
      .catch(err => alert(err.message));
  };

  // LOGIN
  window.login = (email, senha) => {
    signInWithEmailAndPassword(auth, email, senha)
      .then(() => alert("Login realizado!"))
      .catch(err => alert(err.message));
  };

  // LOGOUT
  window.logout = () => {
    signOut(auth);
  };

  // DETECTAR USUÁRIO LOGADO
  onAuthStateChanged(auth, user => {
    if (user) {
      console.log("Usuário logado:", user.email);
    } else {
      console.log("Nenhum usuário logado");
    }
  });

</script>

<body>

<h1>Master Finance - Controle Financeiro 1.0</h1>

<section class="form-section">
    <h2>Novo Lançamento</h2>

    <input type="date" id="data">
    <input type="text" id="descricao" placeholder="Descrição">
    
    <select id="categoria">
        <option>Moradia</option>
        <option>Energia</option>
        <option>Internet</option>
        <option>Saúde</option>
        <option>Alimentação</option>
        <option>Transporte</option>
        <option>Outros</option>
    </select>

    <select id="tipo">
        <option value="receita">Receita</option>
        <option value="despesa">Despesa</option>
    </select>

    <input type="number" id="valor" placeholder="Valor" step="0.01">

    <button onclick="adicionarLancamento()">Adicionar</button>
</section>

<section>
<input id="email" placeholder="Email">
<input id="senha" type="password" placeholder="Senha">

<button onclick="cadastrar(
  document.getElementById('email').value,
  document.getElementById('senha').value
)">Cadastrar</button>

<button onclick="login(
  document.getElementById('email').value,
  document.getElementById('senha').value
)">Login</button>
<button onclick="logout()">Logout</button>
</section>

<section>
    <h2>Extrato</h2>
    <table>
        <thead>
            <tr>
                <th>Status</th>
                <th>Data</th>
                <th>Descrição</th>
                <th>Categoria</th>
                <th>Tipo</th>
                <th>Valor</th>
            </tr>
        </thead>
        <tbody id="tabelaLancamentos"></tbody>
    </table>
</section>

<a href="dashboard.html">Ir para Dashboard</a>

<script src="js/storage.js"></script>
<script src="js/app.js"></script>
</body>
</html>